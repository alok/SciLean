╔═══════════════════════════════════════════════════════════════╗
║           GPU GEMM Benchmark (Views vs Contiguous)                ║
║                                                               ║
║  Tests O(1) transpose views and kernel dispatch overhead      ║
╚═══════════════════════════════════════════════════════════════╝

═══════════════════════════════════════════════════════════════
  GEMM Benchmark: 256×256 @ 256×256 → 256×256
═══════════════════════════════════════════════════════════════

GEMM 256×256×256
================
┌────────────────────────────────────┬────────────────┬──────────────────┐
│ Benchmark                          │ Avg Time       │ Speedup          │
├────────────────────────────────────┼────────────────┼──────────────────┤
│ Direct gemm (baseline)             │ 263.522000us   │ baseline         │
│ Contiguous view                    │ 426.610000us   │ 1.600000x slower │
│ gemmTN (A^T @ B)                   │ 320.585000us   │ 1.200000x slower │
│ gemmNT (A @ B^T)                   │ 391.295000us   │ 1.500000x slower │
│ A^T view                           │ 343.139000us   │ 1.300000x slower │
│ B^T view                           │ 297.133000us   │ 1.100000x slower │
│ Backward (dA + dB)                 │ 605.177000us   │ 2.300000x slower │
└────────────────────────────────────┴────────────────┴──────────────────┘

  FLOPs: 0.030000 GFLOPs
  Performance: ~0.130000 TFLOPs/s

═══════════════════════════════════════════════════════════════
  GEMM Benchmark: 512×512 @ 512×512 → 512×512
═══════════════════════════════════════════════════════════════

GEMM 512×512×512
================
┌────────────────────────────────────┬────────────────┬──────────────────┐
│ Benchmark                          │ Avg Time       │ Speedup          │
├────────────────────────────────────┼────────────────┼──────────────────┤
│ Direct gemm (baseline)             │ 510.914000us   │ baseline         │
│ Contiguous view                    │ 290.075000us   │ 1.800000x faster │
│ gemmTN (A^T @ B)                   │ 209.495000us   │ 2.400000x faster │
│ gemmNT (A @ B^T)                   │ 372.633000us   │ 1.400000x faster │
│ A^T view                           │ 260.643000us   │ 2.000000x faster │
│ B^T view                           │ 276.200000us   │ 1.800000x faster │
│ Backward (dA + dB)                 │ 452.935000us   │ 1.100000x faster │
└────────────────────────────────────┴────────────────┴──────────────────┘

  FLOPs: 0.270000 GFLOPs
  Performance: ~0.530000 TFLOPs/s

═══════════════════════════════════════════════════════════════
  GEMM Benchmark: 1024×1024 @ 1024×1024 → 1024×1024
═══════════════════════════════════════════════════════════════

GEMM 1024×1024×1024
===================
┌────────────────────────────────────┬────────────────┬──────────────────┐
│ Benchmark                          │ Avg Time       │ Speedup          │
├────────────────────────────────────┼────────────────┼──────────────────┤
│ Direct gemm (baseline)             │ 598.718000us   │ baseline         │
│ Contiguous view                    │ 585.802000us   │ baseline         │
│ gemmTN (A^T @ B)                   │ 537.199000us   │ 1.100000x faster │
│ gemmNT (A @ B^T)                   │ 560.118000us   │ 1.100000x faster │
│ A^T view                           │ 539.897000us   │ 1.100000x faster │
│ B^T view                           │ 544.497000us   │ 1.100000x faster │
│ Backward (dA + dB)                 │ 1.063177ms     │ 1.800000x slower │
└────────────────────────────────────┴────────────────┴──────────────────┘

  FLOPs: 2.150000 GFLOPs
  Performance: ~3.590000 TFLOPs/s

═══════════════════════════════════════════════════════════════
  GEMM Benchmark: 2048×2048 @ 2048×2048 → 2048×2048
═══════════════════════════════════════════════════════════════

GEMM 2048×2048×2048
===================
┌────────────────────────────────────┬────────────────┬──────────────────┐
│ Benchmark                          │ Avg Time       │ Speedup          │
├────────────────────────────────────┼────────────────┼──────────────────┤
│ Direct gemm (baseline)             │ 1.702339ms     │ baseline         │
│ Contiguous view                    │ 1.610202ms     │ 1.100000x faster │
│ gemmTN (A^T @ B)                   │ 1.590614ms     │ 1.100000x faster │
│ gemmNT (A @ B^T)                   │ 1.789610ms     │ baseline         │
│ A^T view                           │ 1.596735ms     │ 1.100000x faster │
│ B^T view                           │ 1.779677ms     │ baseline         │
│ Backward (dA + dB)                 │ 3.374464ms     │ 2.000000x slower │
└────────────────────────────────────┴────────────────┴──────────────────┘

  FLOPs: 17.180000 GFLOPs
  Performance: ~10.090000 TFLOPs/s

═══════════════════════════════════════════════════════════════
  O(1) Transpose Overhead (metadata only, no GPU)
═══════════════════════════════════════════════════════════════
  256×256: 17ns avg
  512×512: 17ns avg
  1024×1024: 17ns avg
  2048×2048: 15ns avg
  4096×4096: 16ns avg

  (Transpose is O(1) - just swaps two array elements)

═══════════════════════════════════════════════════════════════
  Dispatch Overhead (layout checks)
═══════════════════════════════════════════════════════════════
  isContiguous: 17ns
  isTransposed: 18ns

══════════════════════════════════════════════════════════════════
  Benchmark Complete

  Key findings:
  • O(1) transpose = just metadata swap, no GPU copy
  • View dispatch adds ~nanoseconds overhead
  • GEMM backward uses same kernels, just different dispatch
══════════════════════════════════════════════════════════════════
